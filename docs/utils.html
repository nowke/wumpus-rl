<html>
    <head>
    <title>utils.py</title>
    </head>
    <body>
    <h3>utils.py (<a href="../utils.py">original</a>)</h3>
    <hr>
    <pre>
<span style="color: green; font-style: italic"># utils.py
# --------
# Licensing Information:
# Please DO NOT DISTRIBUTE OR PUBLISH solutions to this project.
# You are free to use and extend these projects for EDUCATIONAL PURPOSES ONLY.
# The Hunt The Wumpus AI project was developed at University of Arizona
# by Clay Morrison (clayton@sista.arizona.edu), spring 2013.
# This project extends the python code provided by Peter Norvig as part of
# the Artificial Intelligence: A Modern Approach (AIMA) book example code;
# see http://aima.cs.berkeley.edu/code.html
# In particular, the following files come directly from the AIMA python
# code: ['agents.py', 'logic.py', 'search.py', 'utils.py']
# ('logic.py' has been modified by Clay Morrison in locations with the
# comment 'CTM')
# The file ['minisat.py'] implements a slim system call wrapper to the minisat
# (see http://minisat.se) SAT solver, and is directly based on the satispy
# python project, see https://github.com/netom/satispy .

</span><span style="color: darkred">"""Provide some widely useful utilities. Safe for "from utils import *".

"""

</span><span style="color: blue; font-weight: bold">from </span>__future__ <span style="color: blue; font-weight: bold">import </span>generators
<span style="color: blue; font-weight: bold">import </span>operator<span style="font-weight: bold">, </span>math<span style="font-weight: bold">, </span>random<span style="font-weight: bold">, </span>copy<span style="font-weight: bold">, </span>sys<span style="font-weight: bold">, </span>os<span style="font-weight: bold">.</span>path<span style="font-weight: bold">, </span>bisect<span style="font-weight: bold">, </span>re

<span style="color: blue; font-weight: bold">assert </span><span style="font-weight: bold">(</span><span style="color: red">2</span><span style="font-weight: bold">,</span><span style="color: red">5</span><span style="font-weight: bold">) &lt;= </span>sys<span style="font-weight: bold">.</span>version_info <span style="font-weight: bold">&lt; (</span><span style="color: red">3</span><span style="font-weight: bold">,), </span><span style="color: darkred">"""\
This code is meant for Python 2.5 through 2.7.
You might find that the parts you care about still work in older
Pythons or happen to work in newer ones, but you're on your own --
edit utils.py if you want to try it."""

</span><span style="color: green; font-style: italic">#______________________________________________________________________________
# Compatibility with Python 2.2, 2.3, and 2.4

# The AIMA code was originally designed to run in Python 2.2 and up.
# The first part of this file implements for Python 2.2 through 2.4
# the parts of 2.5 that the original code relied on. Now we're
# starting to go beyond what can be filled in this way, but here's
# the compatibility code still since it doesn't hurt:

</span><span style="color: blue; font-weight: bold">try</span><span style="font-weight: bold">: </span>bool<span style="font-weight: bold">, </span><span style="color: blue; font-weight: bold">True</span><span style="font-weight: bold">, </span><span style="color: blue; font-weight: bold">False </span><span style="color: green; font-style: italic">## Introduced in 2.3
</span><span style="color: blue; font-weight: bold">except </span>NameError<span style="font-weight: bold">:
    </span><span style="color: blue; font-weight: bold">class </span>bool<span style="font-weight: bold">(</span>int<span style="font-weight: bold">):
        </span><span style="color: red">"Simple implementation of Booleans, as in PEP 285"
        </span><span style="color: blue; font-weight: bold">def </span>__init__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>val<span style="font-weight: bold">): </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>val <span style="font-weight: bold">= </span>val
        <span style="color: blue; font-weight: bold">def </span>__int__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">): </span><span style="color: blue; font-weight: bold">return </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>val
        <span style="color: blue; font-weight: bold">def </span>__repr__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">): </span><span style="color: blue; font-weight: bold">return </span><span style="font-weight: bold">(</span><span style="color: red">'False'</span><span style="font-weight: bold">, </span><span style="color: red">'True'</span><span style="font-weight: bold">)[</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>val<span style="font-weight: bold">]

    </span><span style="color: blue; font-weight: bold">True</span><span style="font-weight: bold">, </span><span style="color: blue; font-weight: bold">False </span><span style="font-weight: bold">= </span>bool<span style="font-weight: bold">(</span><span style="color: red">1</span><span style="font-weight: bold">), </span>bool<span style="font-weight: bold">(</span><span style="color: red">0</span><span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">try</span><span style="font-weight: bold">: </span>sum <span style="color: green; font-style: italic">## Introduced in 2.3
</span><span style="color: blue; font-weight: bold">except </span>NameError<span style="font-weight: bold">:
    </span><span style="color: blue; font-weight: bold">def </span>sum<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span>start<span style="font-weight: bold">=</span><span style="color: red">0</span><span style="font-weight: bold">):
        </span><span style="color: darkred">"""Sum the elements of seq.
        &gt;&gt;&gt; sum([1, 2, 3])
        6
        """
        </span><span style="color: blue; font-weight: bold">return </span>reduce<span style="font-weight: bold">(</span>operator<span style="font-weight: bold">.</span>add<span style="font-weight: bold">, </span>seq<span style="font-weight: bold">, </span>start<span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">try</span><span style="font-weight: bold">: </span>enumerate  <span style="color: green; font-style: italic">## Introduced in 2.3
</span><span style="color: blue; font-weight: bold">except </span>NameError<span style="font-weight: bold">:
    </span><span style="color: blue; font-weight: bold">def </span>enumerate<span style="font-weight: bold">(</span>collection<span style="font-weight: bold">):
        </span><span style="color: darkred">"""Return an iterator that enumerates pairs of (i, c[i]). PEP 279.
        &gt;&gt;&gt; list(enumerate('abc'))
        [(0, 'a'), (1, 'b'), (2, 'c')]
        """
        </span><span style="color: green; font-style: italic">## Copied from PEP 279
        </span>i <span style="font-weight: bold">= </span><span style="color: red">0
        </span>it <span style="font-weight: bold">= </span>iter<span style="font-weight: bold">(</span>collection<span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">while </span><span style="color: red">1</span><span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">yield </span><span style="font-weight: bold">(</span>i<span style="font-weight: bold">, </span>it<span style="font-weight: bold">.</span>next<span style="font-weight: bold">())
            </span>i <span style="font-weight: bold">+= </span><span style="color: red">1


</span><span style="color: blue; font-weight: bold">try</span><span style="font-weight: bold">: </span>reversed <span style="color: green; font-style: italic">## Introduced in 2.4
</span><span style="color: blue; font-weight: bold">except </span>NameError<span style="font-weight: bold">:
    </span><span style="color: blue; font-weight: bold">def </span>reversed<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">):
        </span><span style="color: darkred">"""Iterate over x in reverse order.
        &gt;&gt;&gt; list(reversed([1,2,3]))
        [3, 2, 1]
        """
        </span><span style="color: blue; font-weight: bold">if </span>hasattr<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span><span style="color: red">'keys'</span><span style="font-weight: bold">):
            </span><span style="color: blue; font-weight: bold">raise </span>TypeError<span style="font-weight: bold">(</span><span style="color: red">"mappings do not support reverse iteration"</span><span style="font-weight: bold">)
        </span>i <span style="font-weight: bold">= </span>len<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">while </span>i <span style="font-weight: bold">&gt; </span><span style="color: red">0</span><span style="font-weight: bold">:
            </span>i <span style="font-weight: bold">-= </span><span style="color: red">1
            </span><span style="color: blue; font-weight: bold">yield </span>seq<span style="font-weight: bold">[</span>i<span style="font-weight: bold">]


</span><span style="color: blue; font-weight: bold">try</span><span style="font-weight: bold">: </span>sorted <span style="color: green; font-style: italic">## Introduced in 2.4
</span><span style="color: blue; font-weight: bold">except </span>NameError<span style="font-weight: bold">:
    </span><span style="color: blue; font-weight: bold">def </span>sorted<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span>cmp<span style="font-weight: bold">=</span><span style="color: blue">None</span><span style="font-weight: bold">, </span>key<span style="font-weight: bold">=</span><span style="color: blue">None</span><span style="font-weight: bold">, </span>reverse<span style="font-weight: bold">=</span><span style="color: blue; font-weight: bold">False</span><span style="font-weight: bold">):
        </span><span style="color: darkred">"""Copy seq and sort and return it.
        &gt;&gt;&gt; sorted([3, 1, 2])
        [1, 2, 3]
        """
        </span>seq2 <span style="font-weight: bold">= </span>copy<span style="font-weight: bold">.</span>copy<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">if </span>key<span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">if </span>cmp <span style="font-weight: bold">== </span><span style="color: blue">None</span><span style="font-weight: bold">:
                </span>cmp <span style="font-weight: bold">= </span>__builtins__<span style="font-weight: bold">.</span>cmp
            seq2<span style="font-weight: bold">.</span>sort<span style="font-weight: bold">(</span><span style="color: blue; font-weight: bold">lambda </span>x<span style="font-weight: bold">,</span>y<span style="font-weight: bold">: </span>cmp<span style="font-weight: bold">(</span>key<span style="font-weight: bold">(</span>x<span style="font-weight: bold">), </span>key<span style="font-weight: bold">(</span>y<span style="font-weight: bold">)))
        </span><span style="color: blue; font-weight: bold">else</span><span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">if </span>cmp <span style="font-weight: bold">== </span><span style="color: blue">None</span><span style="font-weight: bold">:
                </span>seq2<span style="font-weight: bold">.</span>sort<span style="font-weight: bold">()
            </span><span style="color: blue; font-weight: bold">else</span><span style="font-weight: bold">:
                </span>seq2<span style="font-weight: bold">.</span>sort<span style="font-weight: bold">(</span>cmp<span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">if </span>reverse<span style="font-weight: bold">:
            </span>seq2<span style="font-weight: bold">.</span>reverse<span style="font-weight: bold">()
        </span><span style="color: blue; font-weight: bold">return </span>seq2

<span style="color: blue; font-weight: bold">try</span><span style="font-weight: bold">:
    </span>set<span style="font-weight: bold">, </span>frozenset <span style="color: green; font-style: italic">## set builtin introduced in 2.4
</span><span style="color: blue; font-weight: bold">except </span>NameError<span style="font-weight: bold">:
    </span><span style="color: blue; font-weight: bold">try</span><span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">import </span>sets <span style="color: green; font-style: italic">## sets module introduced in 2.3
        </span>set<span style="font-weight: bold">, </span>frozenset <span style="font-weight: bold">= </span>sets<span style="font-weight: bold">.</span>Set<span style="font-weight: bold">, </span>sets<span style="font-weight: bold">.</span>ImmutableSet
    <span style="color: blue; font-weight: bold">except </span><span style="font-weight: bold">(</span>NameError<span style="font-weight: bold">, </span>ImportError<span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">class </span>BaseSet<span style="font-weight: bold">:
            </span><span style="color: red">"set type (see http://docs.python.org/lib/types-set.html)"


            </span><span style="color: blue; font-weight: bold">def </span>__init__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>elements<span style="font-weight: bold">=[]):
                </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict <span style="font-weight: bold">= {}
                </span><span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span>elements<span style="font-weight: bold">:
                    </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">[</span>e<span style="font-weight: bold">] = </span><span style="color: red">1

            </span><span style="color: blue; font-weight: bold">def </span>__len__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">return </span>len<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">)

            </span><span style="color: blue; font-weight: bold">def </span>__iter__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">:
                    </span><span style="color: blue; font-weight: bold">yield </span>e

            <span style="color: blue; font-weight: bold">def </span>__contains__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>element<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">return </span>element <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict

            <span style="color: blue; font-weight: bold">def </span>issubset<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>other<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">.</span>keys<span style="font-weight: bold">():
                    </span><span style="color: blue; font-weight: bold">if </span>e <span style="color: blue; font-weight: bold">not in </span>other<span style="font-weight: bold">:
                        </span><span style="color: blue; font-weight: bold">return False
                return True

            def </span>issuperset<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>other<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span>other<span style="font-weight: bold">:
                    </span><span style="color: blue; font-weight: bold">if </span>e <span style="color: blue; font-weight: bold">not in </span><span style="color: blue">self</span><span style="font-weight: bold">:
                        </span><span style="color: blue; font-weight: bold">return False
                return True


            def </span>union<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>other<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">return </span>type<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">)(</span>list<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">) + </span>list<span style="font-weight: bold">(</span>other<span style="font-weight: bold">))

            </span><span style="color: blue; font-weight: bold">def </span>intersection<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>other<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">return </span>type<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">)([</span>e <span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict <span style="color: blue; font-weight: bold">if </span>e <span style="color: blue; font-weight: bold">in </span>other<span style="font-weight: bold">])

            </span><span style="color: blue; font-weight: bold">def </span>difference<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>other<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">return </span>type<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">)([</span>e <span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict <span style="color: blue; font-weight: bold">if </span>e <span style="color: blue; font-weight: bold">not in </span>other<span style="font-weight: bold">])

            </span><span style="color: blue; font-weight: bold">def </span>symmetric_difference<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>other<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">return </span>type<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">)([</span>e <span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict <span style="color: blue; font-weight: bold">if </span>e <span style="color: blue; font-weight: bold">not in </span>other<span style="font-weight: bold">] +
                                  [</span>e <span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span>other <span style="color: blue; font-weight: bold">if </span>e <span style="color: blue; font-weight: bold">not in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">])

            </span><span style="color: blue; font-weight: bold">def </span>copy<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">return </span>type<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">)(</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">)

            </span><span style="color: blue; font-weight: bold">def </span>__repr__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
                </span>elements <span style="font-weight: bold">= </span><span style="color: red">", "</span><span style="font-weight: bold">.</span>join<span style="font-weight: bold">(</span>map<span style="font-weight: bold">(</span>str<span style="font-weight: bold">, </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">))
                </span><span style="color: blue; font-weight: bold">return </span><span style="color: red">"%s([%s])" </span><span style="font-weight: bold">% (</span>type<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">).</span>__name__<span style="font-weight: bold">, </span>elements<span style="font-weight: bold">)

            </span>__le__ <span style="font-weight: bold">= </span>issubset
            __ge__ <span style="font-weight: bold">= </span>issuperset
            __or__ <span style="font-weight: bold">= </span>union
            __and__ <span style="font-weight: bold">= </span>intersection
            __sub__ <span style="font-weight: bold">= </span>difference
            __xor__ <span style="font-weight: bold">= </span>symmetric_difference

        <span style="color: blue; font-weight: bold">class </span>frozenset<span style="font-weight: bold">(</span>BaseSet<span style="font-weight: bold">):
            </span><span style="color: red">"A frozenset is a BaseSet that has a hash value and is immutable."

            </span><span style="color: blue; font-weight: bold">def </span>__init__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>elements<span style="font-weight: bold">=[]):
                </span>BaseSet<span style="font-weight: bold">.</span>__init__<span style="font-weight: bold">(</span>elements<span style="font-weight: bold">)
                </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>hash <span style="font-weight: bold">= </span><span style="color: red">0
                </span><span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">:
                    </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>hash <span style="font-weight: bold">|= </span>hash<span style="font-weight: bold">(</span>e<span style="font-weight: bold">)

            </span><span style="color: blue; font-weight: bold">def </span>__hash__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">return </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>hash

        <span style="color: blue; font-weight: bold">class </span>set<span style="font-weight: bold">(</span>BaseSet<span style="font-weight: bold">):
            </span><span style="color: red">"A set is a BaseSet that does not have a hash, but is mutable."

            </span><span style="color: blue; font-weight: bold">def </span>update<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>other<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span>other<span style="font-weight: bold">:
                    </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>add<span style="font-weight: bold">(</span>e<span style="font-weight: bold">)
                </span><span style="color: blue; font-weight: bold">return </span><span style="color: blue">self

            </span><span style="color: blue; font-weight: bold">def </span>intersection_update<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>other<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">.</span>keys<span style="font-weight: bold">():
                    </span><span style="color: blue; font-weight: bold">if </span>e <span style="color: blue; font-weight: bold">not in </span>other<span style="font-weight: bold">:
                        </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>remove<span style="font-weight: bold">(</span>e<span style="font-weight: bold">)
                </span><span style="color: blue; font-weight: bold">return </span><span style="color: blue">self

            </span><span style="color: blue; font-weight: bold">def </span>difference_update<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>other<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">.</span>keys<span style="font-weight: bold">():
                    </span><span style="color: blue; font-weight: bold">if </span>e <span style="color: blue; font-weight: bold">in </span>other<span style="font-weight: bold">:
                        </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>remove<span style="font-weight: bold">(</span>e<span style="font-weight: bold">)
                </span><span style="color: blue; font-weight: bold">return </span><span style="color: blue">self

            </span><span style="color: blue; font-weight: bold">def </span>symmetric_difference_update<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>other<span style="font-weight: bold">):
                </span>to_remove1 <span style="font-weight: bold">= [</span>e <span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict <span style="color: blue; font-weight: bold">if </span>e <span style="color: blue; font-weight: bold">in </span>other<span style="font-weight: bold">]
                </span>to_remove2 <span style="font-weight: bold">= [</span>e <span style="color: blue; font-weight: bold">for </span>e <span style="color: blue; font-weight: bold">in </span>other <span style="color: blue; font-weight: bold">if </span>e <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">]
                </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>difference_update<span style="font-weight: bold">(</span>to_remove1<span style="font-weight: bold">)
                </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>difference_update<span style="font-weight: bold">(</span>to_remove2<span style="font-weight: bold">)
                </span><span style="color: blue; font-weight: bold">return </span><span style="color: blue">self

            </span><span style="color: blue; font-weight: bold">def </span>add<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>element<span style="font-weight: bold">):
                </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">[</span>element<span style="font-weight: bold">] = </span><span style="color: red">1

            </span><span style="color: blue; font-weight: bold">def </span>remove<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>element<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">del </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">[</span>element<span style="font-weight: bold">]

            </span><span style="color: blue; font-weight: bold">def </span>discard<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>element<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">if </span>element <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">:
                    </span><span style="color: blue; font-weight: bold">del </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">[</span>element<span style="font-weight: bold">]

            </span><span style="color: blue; font-weight: bold">def </span>pop<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
                </span>key<span style="font-weight: bold">, </span>val <span style="font-weight: bold">= </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">.</span>popitem<span style="font-weight: bold">()
                </span><span style="color: blue; font-weight: bold">return </span>key

            <span style="color: blue; font-weight: bold">def </span>clear<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
                </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>dict<span style="font-weight: bold">.</span>clear<span style="font-weight: bold">()

            </span>__ior__ <span style="font-weight: bold">= </span>update
            __iand__ <span style="font-weight: bold">= </span>intersection_update
            __isub__ <span style="font-weight: bold">= </span>difference_update
            __ixor__ <span style="font-weight: bold">= </span>symmetric_difference_update




<span style="color: green; font-style: italic">#______________________________________________________________________________
# Simple Data Structures: infinity, Dict, Struct

</span>infinity <span style="font-weight: bold">= </span><span style="color: red">1.0</span>e400

<span style="color: blue; font-weight: bold">def </span>Dict<span style="font-weight: bold">(**</span>entries<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Create a dict out of the argument=value arguments.
    &gt;&gt;&gt; Dict(a=1, b=2, c=3)
    {'a': 1, 'c': 3, 'b': 2}
    """
    </span><span style="color: blue; font-weight: bold">return </span>entries

<span style="color: blue; font-weight: bold">class </span>DefaultDict<span style="font-weight: bold">(</span>dict<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Dictionary with a default value for unknown keys."""
    </span><span style="color: blue; font-weight: bold">def </span>__init__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>default<span style="font-weight: bold">):
        </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>default <span style="font-weight: bold">= </span>default

    <span style="color: blue; font-weight: bold">def </span>__getitem__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>key<span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">if </span>key <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">: </span><span style="color: blue; font-weight: bold">return </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>get<span style="font-weight: bold">(</span>key<span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">return </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>setdefault<span style="font-weight: bold">(</span>key<span style="font-weight: bold">, </span>copy<span style="font-weight: bold">.</span>deepcopy<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>default<span style="font-weight: bold">))

    </span><span style="color: blue; font-weight: bold">def </span>__copy__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
        </span>copy <span style="font-weight: bold">= </span>DefaultDict<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>default<span style="font-weight: bold">)
        </span>copy<span style="font-weight: bold">.</span>update<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">return </span>copy

<span style="color: blue; font-weight: bold">class </span>Struct<span style="font-weight: bold">:
    </span><span style="color: darkred">"""Create an instance with argument=value slots.
    This is for making a lightweight object whose class doesn't matter."""
    </span><span style="color: blue; font-weight: bold">def </span>__init__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, **</span>entries<span style="font-weight: bold">):
        </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>__dict__<span style="font-weight: bold">.</span>update<span style="font-weight: bold">(</span>entries<span style="font-weight: bold">)

    </span><span style="color: blue; font-weight: bold">def </span>__cmp__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>other<span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">if </span>isinstance<span style="font-weight: bold">(</span>other<span style="font-weight: bold">, </span>Struct<span style="font-weight: bold">):
            </span><span style="color: blue; font-weight: bold">return </span>cmp<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>__dict__<span style="font-weight: bold">, </span>other<span style="font-weight: bold">.</span>__dict__<span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">else</span><span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">return </span>cmp<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>__dict__<span style="font-weight: bold">, </span>other<span style="font-weight: bold">)

    </span><span style="color: blue; font-weight: bold">def </span>__repr__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
        </span>args <span style="font-weight: bold">= [</span><span style="color: red">'%s=%s' </span><span style="font-weight: bold">% (</span>k<span style="font-weight: bold">, </span>repr<span style="font-weight: bold">(</span>v<span style="font-weight: bold">)) </span><span style="color: blue; font-weight: bold">for </span><span style="font-weight: bold">(</span>k<span style="font-weight: bold">, </span>v<span style="font-weight: bold">) </span><span style="color: blue; font-weight: bold">in </span>vars<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">).</span>items<span style="font-weight: bold">()]
        </span><span style="color: blue; font-weight: bold">return </span><span style="color: red">'Struct(%s)' </span><span style="font-weight: bold">% </span><span style="color: red">', '</span><span style="font-weight: bold">.</span>join<span style="font-weight: bold">(</span>sorted<span style="font-weight: bold">(</span>args<span style="font-weight: bold">))

</span><span style="color: blue; font-weight: bold">def </span>update<span style="font-weight: bold">(</span>x<span style="font-weight: bold">, **</span>entries<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Update a dict; or an object with slots; according to entries.
    &gt;&gt;&gt; update({'a': 1}, a=10, b=20)
    {'a': 10, 'b': 20}
    &gt;&gt;&gt; update(Struct(a=1), a=10, b=20)
    Struct(a=10, b=20)
    """
    </span><span style="color: blue; font-weight: bold">if </span>isinstance<span style="font-weight: bold">(</span>x<span style="font-weight: bold">, </span>dict<span style="font-weight: bold">):
        </span>x<span style="font-weight: bold">.</span>update<span style="font-weight: bold">(</span>entries<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">else</span><span style="font-weight: bold">:
        </span>x<span style="font-weight: bold">.</span>__dict__<span style="font-weight: bold">.</span>update<span style="font-weight: bold">(</span>entries<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">return </span>x

<span style="color: green; font-style: italic">#______________________________________________________________________________
# Functions on Sequences (mostly inspired by Common Lisp)
# NOTE: Sequence functions (count_if, find_if, every, some) take function
# argument first (like reduce, filter, and map).

</span><span style="color: blue; font-weight: bold">def </span>removeall<span style="font-weight: bold">(</span>item<span style="font-weight: bold">, </span>seq<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return a copy of seq (or string) with all occurences of item removed.
    &gt;&gt;&gt; removeall(3, [1, 2, 3, 3, 2, 1, 3])
    [1, 2, 2, 1]
    &gt;&gt;&gt; removeall(4, [1, 2, 3])
    [1, 2, 3]
    """
    </span><span style="color: blue; font-weight: bold">if </span>isinstance<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span>str<span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">return </span>seq<span style="font-weight: bold">.</span>replace<span style="font-weight: bold">(</span>item<span style="font-weight: bold">, </span><span style="color: red">''</span><span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">else</span><span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">return </span><span style="font-weight: bold">[</span>x <span style="color: blue; font-weight: bold">for </span>x <span style="color: blue; font-weight: bold">in </span>seq <span style="color: blue; font-weight: bold">if </span>x <span style="font-weight: bold">!= </span>item<span style="font-weight: bold">]

</span><span style="color: blue; font-weight: bold">def </span>unique<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Remove duplicate elements from seq. Assumes hashable elements.
    &gt;&gt;&gt; unique([1, 2, 3, 2, 1])
    [1, 2, 3]
    """
    </span><span style="color: blue; font-weight: bold">return </span>list<span style="font-weight: bold">(</span>set<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">))

</span><span style="color: blue; font-weight: bold">def </span>product<span style="font-weight: bold">(</span>numbers<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return the product of the numbers.
    &gt;&gt;&gt; product([1,2,3,4])
    24
    """
    </span><span style="color: blue; font-weight: bold">return </span>reduce<span style="font-weight: bold">(</span>operator<span style="font-weight: bold">.</span>mul<span style="font-weight: bold">, </span>numbers<span style="font-weight: bold">, </span><span style="color: red">1</span><span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>count_if<span style="font-weight: bold">(</span>predicate<span style="font-weight: bold">, </span>seq<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Count the number of elements of seq for which the predicate is true.
    &gt;&gt;&gt; count_if(callable, [42, None, max, min])
    2
    """
    </span>f <span style="font-weight: bold">= </span><span style="color: blue; font-weight: bold">lambda </span>count<span style="font-weight: bold">, </span>x<span style="font-weight: bold">: </span>count <span style="font-weight: bold">+ (</span><span style="color: blue; font-weight: bold">not not </span>predicate<span style="font-weight: bold">(</span>x<span style="font-weight: bold">))
    </span><span style="color: blue; font-weight: bold">return </span>reduce<span style="font-weight: bold">(</span>f<span style="font-weight: bold">, </span>seq<span style="font-weight: bold">, </span><span style="color: red">0</span><span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>find_if<span style="font-weight: bold">(</span>predicate<span style="font-weight: bold">, </span>seq<span style="font-weight: bold">):
    </span><span style="color: darkred">"""If there is an element of seq that satisfies predicate; return it.
    &gt;&gt;&gt; find_if(callable, [3, min, max])
    &lt;built-in function min&gt;
    &gt;&gt;&gt; find_if(callable, [1, 2, 3])
    """
    </span><span style="color: blue; font-weight: bold">for </span>x <span style="color: blue; font-weight: bold">in </span>seq<span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">if </span>predicate<span style="font-weight: bold">(</span>x<span style="font-weight: bold">): </span><span style="color: blue; font-weight: bold">return </span>x
    <span style="color: blue; font-weight: bold">return </span><span style="color: blue">None

</span><span style="color: blue; font-weight: bold">def </span>every<span style="font-weight: bold">(</span>predicate<span style="font-weight: bold">, </span>seq<span style="font-weight: bold">):
    </span><span style="color: darkred">"""True if every element of seq satisfies predicate.
    &gt;&gt;&gt; every(callable, [min, max])
    1
    &gt;&gt;&gt; every(callable, [min, 3])
    0
    """
    </span><span style="color: blue; font-weight: bold">for </span>x <span style="color: blue; font-weight: bold">in </span>seq<span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">if not </span>predicate<span style="font-weight: bold">(</span>x<span style="font-weight: bold">): </span><span style="color: blue; font-weight: bold">return False
    return True

def </span>some<span style="font-weight: bold">(</span>predicate<span style="font-weight: bold">, </span>seq<span style="font-weight: bold">):
    </span><span style="color: darkred">"""If some element x of seq satisfies predicate(x), return predicate(x).
    &gt;&gt;&gt; some(callable, [min, 3])
    1
    &gt;&gt;&gt; some(callable, [2, 3])
    0
    """
    </span><span style="color: blue; font-weight: bold">for </span>x <span style="color: blue; font-weight: bold">in </span>seq<span style="font-weight: bold">:
        </span>px <span style="font-weight: bold">= </span>predicate<span style="font-weight: bold">(</span>x<span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">if </span>px<span style="font-weight: bold">: </span><span style="color: blue; font-weight: bold">return </span>px
    <span style="color: blue; font-weight: bold">return False

def </span>isin<span style="font-weight: bold">(</span>elt<span style="font-weight: bold">, </span>seq<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Like (elt in seq), but compares with is, not ==.
    &gt;&gt;&gt; e = []; isin(e, [1, e, 3])
    True
    &gt;&gt;&gt; isin(e, [1, [], 3])
    False
    """
    </span><span style="color: blue; font-weight: bold">for </span>x <span style="color: blue; font-weight: bold">in </span>seq<span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">if </span>elt <span style="color: blue; font-weight: bold">is </span>x<span style="font-weight: bold">: </span><span style="color: blue; font-weight: bold">return True
    return False

</span><span style="color: green; font-style: italic">#______________________________________________________________________________
# Functions on sequences of numbers
# NOTE: these take the sequence argument first, like min and max,
# and like standard math notation: \sigma (i = 1..n) fn(i)
# A lot of programing is finding the best value that satisfies some condition;
# so there are three versions of argmin/argmax, depending on what you want to
# do with ties: return the first one, return them all, or pick at random.

</span><span style="color: blue; font-weight: bold">def </span>argmin<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span>fn<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return an element with lowest fn(seq[i]) score; tie goes to first one.
    &gt;&gt;&gt; argmin(['one', 'to', 'three'], len)
    'to'
    """
    </span>best <span style="font-weight: bold">= </span>seq<span style="font-weight: bold">[</span><span style="color: red">0</span><span style="font-weight: bold">]</span>; best_score <span style="font-weight: bold">= </span>fn<span style="font-weight: bold">(</span>best<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">for </span>x <span style="color: blue; font-weight: bold">in </span>seq<span style="font-weight: bold">:
        </span>x_score <span style="font-weight: bold">= </span>fn<span style="font-weight: bold">(</span>x<span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">if </span>x_score <span style="font-weight: bold">&lt; </span>best_score<span style="font-weight: bold">:
            </span>best<span style="font-weight: bold">, </span>best_score <span style="font-weight: bold">= </span>x<span style="font-weight: bold">, </span>x_score
    <span style="color: blue; font-weight: bold">return </span>best

<span style="color: blue; font-weight: bold">def </span>argmin_list<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span>fn<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return a list of elements of seq[i] with the lowest fn(seq[i]) scores.
    &gt;&gt;&gt; argmin_list(['one', 'to', 'three', 'or'], len)
    ['to', 'or']
    """
    </span>best_score<span style="font-weight: bold">, </span>best <span style="font-weight: bold">= </span>fn<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">[</span><span style="color: red">0</span><span style="font-weight: bold">]), []
    </span><span style="color: blue; font-weight: bold">for </span>x <span style="color: blue; font-weight: bold">in </span>seq<span style="font-weight: bold">:
        </span>x_score <span style="font-weight: bold">= </span>fn<span style="font-weight: bold">(</span>x<span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">if </span>x_score <span style="font-weight: bold">&lt; </span>best_score<span style="font-weight: bold">:
            </span>best<span style="font-weight: bold">, </span>best_score <span style="font-weight: bold">= [</span>x<span style="font-weight: bold">], </span>x_score
        <span style="color: blue; font-weight: bold">elif </span>x_score <span style="font-weight: bold">== </span>best_score<span style="font-weight: bold">:
            </span>best<span style="font-weight: bold">.</span>append<span style="font-weight: bold">(</span>x<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">return </span>best

<span style="color: blue; font-weight: bold">def </span>argmin_random_tie<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span>fn<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return an element with lowest fn(seq[i]) score; break ties at random.
    Thus, for all s,f: argmin_random_tie(s, f) in argmin_list(s, f)"""
    </span>best_score <span style="font-weight: bold">= </span>fn<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">[</span><span style="color: red">0</span><span style="font-weight: bold">])</span>; n <span style="font-weight: bold">= </span><span style="color: red">0
    </span><span style="color: blue; font-weight: bold">for </span>x <span style="color: blue; font-weight: bold">in </span>seq<span style="font-weight: bold">:
        </span>x_score <span style="font-weight: bold">= </span>fn<span style="font-weight: bold">(</span>x<span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">if </span>x_score <span style="font-weight: bold">&lt; </span>best_score<span style="font-weight: bold">:
            </span>best<span style="font-weight: bold">, </span>best_score <span style="font-weight: bold">= </span>x<span style="font-weight: bold">, </span>x_score; n <span style="font-weight: bold">= </span><span style="color: red">1
        </span><span style="color: blue; font-weight: bold">elif </span>x_score <span style="font-weight: bold">== </span>best_score<span style="font-weight: bold">:
            </span>n <span style="font-weight: bold">+= </span><span style="color: red">1
            </span><span style="color: blue; font-weight: bold">if </span>random<span style="font-weight: bold">.</span>randrange<span style="font-weight: bold">(</span>n<span style="font-weight: bold">) == </span><span style="color: red">0</span><span style="font-weight: bold">:
                </span>best <span style="font-weight: bold">= </span>x
    <span style="color: blue; font-weight: bold">return </span>best

<span style="color: blue; font-weight: bold">def </span>argmax<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span>fn<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return an element with highest fn(seq[i]) score; tie goes to first one.
    &gt;&gt;&gt; argmax(['one', 'to', 'three'], len)
    'three'
    """
    </span><span style="color: blue; font-weight: bold">return </span>argmin<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span><span style="color: blue; font-weight: bold">lambda </span>x<span style="font-weight: bold">: -</span>fn<span style="font-weight: bold">(</span>x<span style="font-weight: bold">))

</span><span style="color: blue; font-weight: bold">def </span>argmax_list<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span>fn<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return a list of elements of seq[i] with the highest fn(seq[i]) scores.
    &gt;&gt;&gt; argmax_list(['one', 'three', 'seven'], len)
    ['three', 'seven']
    """
    </span><span style="color: blue; font-weight: bold">return </span>argmin_list<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span><span style="color: blue; font-weight: bold">lambda </span>x<span style="font-weight: bold">: -</span>fn<span style="font-weight: bold">(</span>x<span style="font-weight: bold">))

</span><span style="color: blue; font-weight: bold">def </span>argmax_random_tie<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span>fn<span style="font-weight: bold">):
    </span><span style="color: red">"Return an element with highest fn(seq[i]) score; break ties at random."
    </span><span style="color: blue; font-weight: bold">return </span>argmin_random_tie<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span><span style="color: blue; font-weight: bold">lambda </span>x<span style="font-weight: bold">: -</span>fn<span style="font-weight: bold">(</span>x<span style="font-weight: bold">))
</span><span style="color: green; font-style: italic">#______________________________________________________________________________
# Statistical and mathematical functions

</span><span style="color: blue; font-weight: bold">def </span>histogram<span style="font-weight: bold">(</span>values<span style="font-weight: bold">, </span>mode<span style="font-weight: bold">=</span><span style="color: red">0</span><span style="font-weight: bold">, </span>bin_function<span style="font-weight: bold">=</span><span style="color: blue">None</span><span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return a list of (value, count) pairs, summarizing the input values.
    Sorted by increasing value, or if mode=1, by decreasing count.
    If bin_function is given, map it over values first."""
    </span><span style="color: blue; font-weight: bold">if </span>bin_function<span style="font-weight: bold">: </span>values <span style="font-weight: bold">= </span>map<span style="font-weight: bold">(</span>bin_function<span style="font-weight: bold">, </span>values<span style="font-weight: bold">)
    </span>bins <span style="font-weight: bold">= {}
    </span><span style="color: blue; font-weight: bold">for </span>val <span style="color: blue; font-weight: bold">in </span>values<span style="font-weight: bold">:
        </span>bins<span style="font-weight: bold">[</span>val<span style="font-weight: bold">] = </span>bins<span style="font-weight: bold">.</span>get<span style="font-weight: bold">(</span>val<span style="font-weight: bold">, </span><span style="color: red">0</span><span style="font-weight: bold">) + </span><span style="color: red">1
    </span><span style="color: blue; font-weight: bold">if </span>mode<span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">return </span>sorted<span style="font-weight: bold">(</span>bins<span style="font-weight: bold">.</span>items<span style="font-weight: bold">(), </span>key<span style="font-weight: bold">=</span><span style="color: blue; font-weight: bold">lambda </span>x<span style="font-weight: bold">: (</span>x<span style="font-weight: bold">[</span><span style="color: red">1</span><span style="font-weight: bold">],</span>x<span style="font-weight: bold">[</span><span style="color: red">0</span><span style="font-weight: bold">]), </span>reverse<span style="font-weight: bold">=</span><span style="color: blue; font-weight: bold">True</span><span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">else</span><span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">return </span>sorted<span style="font-weight: bold">(</span>bins<span style="font-weight: bold">.</span>items<span style="font-weight: bold">())

</span><span style="color: blue; font-weight: bold">def </span>log2<span style="font-weight: bold">(</span>x<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Base 2 logarithm.
    &gt;&gt;&gt; log2(1024)
    10.0
    """
    </span><span style="color: blue; font-weight: bold">return </span>math<span style="font-weight: bold">.</span>log10<span style="font-weight: bold">(</span>x<span style="font-weight: bold">) / </span>math<span style="font-weight: bold">.</span>log10<span style="font-weight: bold">(</span><span style="color: red">2</span><span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>mode<span style="font-weight: bold">(</span>values<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return the most common value in the list of values.
    &gt;&gt;&gt; mode([1, 2, 3, 2])
    2
    """
    </span><span style="color: blue; font-weight: bold">return </span>histogram<span style="font-weight: bold">(</span>values<span style="font-weight: bold">, </span>mode<span style="font-weight: bold">=</span><span style="color: red">1</span><span style="font-weight: bold">)[</span><span style="color: red">0</span><span style="font-weight: bold">][</span><span style="color: red">0</span><span style="font-weight: bold">]

</span><span style="color: blue; font-weight: bold">def </span>median<span style="font-weight: bold">(</span>values<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return the middle value, when the values are sorted.
    If there are an odd number of elements, try to average the middle two.
    If they can't be averaged (e.g. they are strings), choose one at random.
    &gt;&gt;&gt; median([10, 100, 11])
    11
    &gt;&gt;&gt; median([1, 2, 3, 4])
    2.5
    """
    </span>n <span style="font-weight: bold">= </span>len<span style="font-weight: bold">(</span>values<span style="font-weight: bold">)
    </span>values <span style="font-weight: bold">= </span>sorted<span style="font-weight: bold">(</span>values<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">if </span>n <span style="font-weight: bold">% </span><span style="color: red">2 </span><span style="font-weight: bold">== </span><span style="color: red">1</span><span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">return </span>values<span style="font-weight: bold">[</span>n<span style="font-weight: bold">/</span><span style="color: red">2</span><span style="font-weight: bold">]
    </span><span style="color: blue; font-weight: bold">else</span><span style="font-weight: bold">:
        </span>middle2 <span style="font-weight: bold">= </span>values<span style="font-weight: bold">[(</span>n<span style="font-weight: bold">/</span><span style="color: red">2</span><span style="font-weight: bold">)-</span><span style="color: red">1</span><span style="font-weight: bold">:(</span>n<span style="font-weight: bold">/</span><span style="color: red">2</span><span style="font-weight: bold">)+</span><span style="color: red">1</span><span style="font-weight: bold">]
        </span><span style="color: blue; font-weight: bold">try</span><span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">return </span>mean<span style="font-weight: bold">(</span>middle2<span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">except </span>TypeError<span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">return </span>random<span style="font-weight: bold">.</span>choice<span style="font-weight: bold">(</span>middle2<span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>mean<span style="font-weight: bold">(</span>values<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return the arithmetic average of the values."""
    </span><span style="color: blue; font-weight: bold">return </span>sum<span style="font-weight: bold">(</span>values<span style="font-weight: bold">) / </span>float<span style="font-weight: bold">(</span>len<span style="font-weight: bold">(</span>values<span style="font-weight: bold">))

</span><span style="color: blue; font-weight: bold">def </span>stddev<span style="font-weight: bold">(</span>values<span style="font-weight: bold">, </span>meanval<span style="font-weight: bold">=</span><span style="color: blue">None</span><span style="font-weight: bold">):
    </span><span style="color: darkred">"""The standard deviation of a set of values.
    Pass in the mean if you already know it."""
    </span><span style="color: blue; font-weight: bold">if </span>meanval <span style="color: blue; font-weight: bold">is </span><span style="color: blue">None</span><span style="font-weight: bold">: </span>meanval <span style="font-weight: bold">= </span>mean<span style="font-weight: bold">(</span>values<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">return </span>math<span style="font-weight: bold">.</span>sqrt<span style="font-weight: bold">(</span>sum<span style="font-weight: bold">([(</span>x <span style="font-weight: bold">- </span>meanval<span style="font-weight: bold">)**</span><span style="color: red">2 </span><span style="color: blue; font-weight: bold">for </span>x <span style="color: blue; font-weight: bold">in </span>values<span style="font-weight: bold">]) / (</span>len<span style="font-weight: bold">(</span>values<span style="font-weight: bold">)-</span><span style="color: red">1</span><span style="font-weight: bold">))

</span><span style="color: blue; font-weight: bold">def </span>dotproduct<span style="font-weight: bold">(</span>X<span style="font-weight: bold">, </span>Y<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return the sum of the element-wise product of vectors x and y.
    &gt;&gt;&gt; dotproduct([1, 2, 3], [1000, 100, 10])
    1230
    """
    </span><span style="color: blue; font-weight: bold">return </span>sum<span style="font-weight: bold">([</span>x <span style="font-weight: bold">* </span>y <span style="color: blue; font-weight: bold">for </span>x<span style="font-weight: bold">, </span>y <span style="color: blue; font-weight: bold">in </span>zip<span style="font-weight: bold">(</span>X<span style="font-weight: bold">, </span>Y<span style="font-weight: bold">)])

</span><span style="color: blue; font-weight: bold">def </span>vector_add<span style="font-weight: bold">(</span>a<span style="font-weight: bold">, </span>b<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Component-wise addition of two vectors.
    &gt;&gt;&gt; vector_add((0, 1), (8, 9))
    (8, 10)
    """
    </span><span style="color: blue; font-weight: bold">return </span>tuple<span style="font-weight: bold">(</span>map<span style="font-weight: bold">(</span>operator<span style="font-weight: bold">.</span>add<span style="font-weight: bold">, </span>a<span style="font-weight: bold">, </span>b<span style="font-weight: bold">))

</span><span style="color: blue; font-weight: bold">def </span>probability<span style="font-weight: bold">(</span>p<span style="font-weight: bold">):
    </span><span style="color: red">"Return true with probability p."
    </span><span style="color: blue; font-weight: bold">return </span>p <span style="font-weight: bold">&gt; </span>random<span style="font-weight: bold">.</span>uniform<span style="font-weight: bold">(</span><span style="color: red">0.0</span><span style="font-weight: bold">, </span><span style="color: red">1.0</span><span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>weighted_sample_with_replacement<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span>weights<span style="font-weight: bold">, </span>n<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Pick n samples from seq at random, with replacement, with the
    probability of each element in proportion to its corresponding
    weight."""
    </span>sample <span style="font-weight: bold">= </span>weighted_sampler<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span>weights<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">return </span><span style="font-weight: bold">[</span>sample<span style="font-weight: bold">() </span><span style="color: blue; font-weight: bold">for </span>s <span style="color: blue; font-weight: bold">in </span>range<span style="font-weight: bold">(</span>n<span style="font-weight: bold">)]

</span><span style="color: blue; font-weight: bold">def </span>weighted_sampler<span style="font-weight: bold">(</span>seq<span style="font-weight: bold">, </span>weights<span style="font-weight: bold">):
    </span><span style="color: red">"Return a random-sample function that picks from seq weighted by weights."
    </span>totals <span style="font-weight: bold">= []
    </span><span style="color: blue; font-weight: bold">for </span>w <span style="color: blue; font-weight: bold">in </span>weights<span style="font-weight: bold">:
        </span>totals<span style="font-weight: bold">.</span>append<span style="font-weight: bold">(</span>w <span style="font-weight: bold">+ </span>totals<span style="font-weight: bold">[-</span><span style="color: red">1</span><span style="font-weight: bold">] </span><span style="color: blue; font-weight: bold">if </span>totals <span style="color: blue; font-weight: bold">else </span>w<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">return lambda</span><span style="font-weight: bold">: </span>seq<span style="font-weight: bold">[</span>bisect<span style="font-weight: bold">.</span>bisect<span style="font-weight: bold">(</span>totals<span style="font-weight: bold">, </span>random<span style="font-weight: bold">.</span>uniform<span style="font-weight: bold">(</span><span style="color: red">0</span><span style="font-weight: bold">, </span>totals<span style="font-weight: bold">[-</span><span style="color: red">1</span><span style="font-weight: bold">]))]

</span><span style="color: blue; font-weight: bold">def </span>num_or_str<span style="font-weight: bold">(</span>x<span style="font-weight: bold">):
    </span><span style="color: darkred">"""The argument is a string; convert to a number if possible, or strip it.
    &gt;&gt;&gt; num_or_str('42')
    42
    &gt;&gt;&gt; num_or_str(' 42x ')
    '42x'
    """
    </span><span style="color: blue; font-weight: bold">if </span>isnumber<span style="font-weight: bold">(</span>x<span style="font-weight: bold">): </span><span style="color: blue; font-weight: bold">return </span>x
    <span style="color: blue; font-weight: bold">try</span><span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">return </span>int<span style="font-weight: bold">(</span>x<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">except </span>ValueError<span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">try</span><span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">return </span>float<span style="font-weight: bold">(</span>x<span style="font-weight: bold">)
        </span><span style="color: blue; font-weight: bold">except </span>ValueError<span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">return </span>str<span style="font-weight: bold">(</span>x<span style="font-weight: bold">).</span>strip<span style="font-weight: bold">()

</span><span style="color: blue; font-weight: bold">def </span>normalize<span style="font-weight: bold">(</span>numbers<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Multiply each number by a constant such that the sum is 1.0
    &gt;&gt;&gt; normalize([1,2,1])
    [0.25, 0.5, 0.25]
    """
    </span>total <span style="font-weight: bold">= </span>float<span style="font-weight: bold">(</span>sum<span style="font-weight: bold">(</span>numbers<span style="font-weight: bold">))
    </span><span style="color: blue; font-weight: bold">return </span><span style="font-weight: bold">[</span>n <span style="font-weight: bold">/ </span>total <span style="color: blue; font-weight: bold">for </span>n <span style="color: blue; font-weight: bold">in </span>numbers<span style="font-weight: bold">]

</span><span style="color: blue; font-weight: bold">def </span>clip<span style="font-weight: bold">(</span>x<span style="font-weight: bold">, </span>lowest<span style="font-weight: bold">, </span>highest<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return x clipped to the range [lowest..highest].
    &gt;&gt;&gt; [clip(x, 0, 1) for x in [-1, 0.5, 10]]
    [0, 0.5, 1]
    """
    </span><span style="color: blue; font-weight: bold">return </span>max<span style="font-weight: bold">(</span>lowest<span style="font-weight: bold">, </span>min<span style="font-weight: bold">(</span>x<span style="font-weight: bold">, </span>highest<span style="font-weight: bold">))

</span><span style="color: green; font-style: italic">#______________________________________________________________________________
## OK, the following are not as widely useful utilities as some of the other
## functions here, but they do show up wherever we have 2D grids: Wumpus and
## Vacuum worlds, TicTacToe and Checkers, and markov decision Processes.

</span>orientations <span style="font-weight: bold">= [(</span><span style="color: red">1</span><span style="font-weight: bold">, </span><span style="color: red">0</span><span style="font-weight: bold">), (</span><span style="color: red">0</span><span style="font-weight: bold">, </span><span style="color: red">1</span><span style="font-weight: bold">), (-</span><span style="color: red">1</span><span style="font-weight: bold">, </span><span style="color: red">0</span><span style="font-weight: bold">), (</span><span style="color: red">0</span><span style="font-weight: bold">, -</span><span style="color: red">1</span><span style="font-weight: bold">)]

</span><span style="color: blue; font-weight: bold">def </span>turn_heading<span style="font-weight: bold">(</span>heading<span style="font-weight: bold">, </span>inc<span style="font-weight: bold">, </span>headings<span style="font-weight: bold">=</span>orientations<span style="font-weight: bold">):
    </span><span style="color: blue; font-weight: bold">return </span>headings<span style="font-weight: bold">[(</span>headings<span style="font-weight: bold">.</span>index<span style="font-weight: bold">(</span>heading<span style="font-weight: bold">) + </span>inc<span style="font-weight: bold">) % </span>len<span style="font-weight: bold">(</span>headings<span style="font-weight: bold">)]

</span><span style="color: blue; font-weight: bold">def </span>turn_right<span style="font-weight: bold">(</span>heading<span style="font-weight: bold">):
    </span><span style="color: blue; font-weight: bold">return </span>turn_heading<span style="font-weight: bold">(</span>heading<span style="font-weight: bold">, -</span><span style="color: red">1</span><span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>turn_left<span style="font-weight: bold">(</span>heading<span style="font-weight: bold">):
    </span><span style="color: blue; font-weight: bold">return </span>turn_heading<span style="font-weight: bold">(</span>heading<span style="font-weight: bold">, +</span><span style="color: red">1</span><span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>distance<span style="font-weight: bold">((</span>ax<span style="font-weight: bold">, </span>ay<span style="font-weight: bold">), (</span>bx<span style="font-weight: bold">, </span>by<span style="font-weight: bold">)):
    </span><span style="color: red">"The distance between two (x, y) points."
    </span><span style="color: blue; font-weight: bold">return </span>math<span style="font-weight: bold">.</span>hypot<span style="font-weight: bold">((</span>ax <span style="font-weight: bold">- </span>bx<span style="font-weight: bold">), (</span>ay <span style="font-weight: bold">- </span>by<span style="font-weight: bold">))

</span><span style="color: blue; font-weight: bold">def </span>distance2<span style="font-weight: bold">((</span>ax<span style="font-weight: bold">, </span>ay<span style="font-weight: bold">), (</span>bx<span style="font-weight: bold">, </span>by<span style="font-weight: bold">)):
    </span><span style="color: red">"The square of the distance between two (x, y) points."
    </span><span style="color: blue; font-weight: bold">return </span><span style="font-weight: bold">(</span>ax <span style="font-weight: bold">- </span>bx<span style="font-weight: bold">)**</span><span style="color: red">2 </span><span style="font-weight: bold">+ (</span>ay <span style="font-weight: bold">- </span>by<span style="font-weight: bold">)**</span><span style="color: red">2

</span><span style="color: blue; font-weight: bold">def </span>vector_clip<span style="font-weight: bold">(</span>vector<span style="font-weight: bold">, </span>lowest<span style="font-weight: bold">, </span>highest<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return vector, except if any element is less than the corresponding
    value of lowest or more than the corresponding value of highest, clip to
    those values.
    &gt;&gt;&gt; vector_clip((-1, 10), (0, 0), (9, 9))
    (0, 9)
    """
    </span><span style="color: blue; font-weight: bold">return </span>type<span style="font-weight: bold">(</span>vector<span style="font-weight: bold">)(</span>map<span style="font-weight: bold">(</span>clip<span style="font-weight: bold">, </span>vector<span style="font-weight: bold">, </span>lowest<span style="font-weight: bold">, </span>highest<span style="font-weight: bold">))

</span><span style="color: green; font-style: italic">#______________________________________________________________________________
# Misc Functions

</span><span style="color: blue; font-weight: bold">def </span>printf<span style="font-weight: bold">(</span>format<span style="font-weight: bold">, *</span>args<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Format args with the first argument as format string, and write.
    Return the last arg, or format itself if there are no args."""
    </span>sys<span style="font-weight: bold">.</span>stdout<span style="font-weight: bold">.</span>write<span style="font-weight: bold">(</span>str<span style="font-weight: bold">(</span>format<span style="font-weight: bold">) % </span>args<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">return </span>if_<span style="font-weight: bold">(</span>args<span style="font-weight: bold">, </span><span style="color: blue; font-weight: bold">lambda</span><span style="font-weight: bold">: </span>args<span style="font-weight: bold">[-</span><span style="color: red">1</span><span style="font-weight: bold">], </span><span style="color: blue; font-weight: bold">lambda</span><span style="font-weight: bold">: </span>format<span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>caller<span style="font-weight: bold">(</span>n<span style="font-weight: bold">=</span><span style="color: red">1</span><span style="font-weight: bold">):
    </span><span style="color: darkred">"""Return the name of the calling function n levels up in the frame stack.
    &gt;&gt;&gt; caller(0)
    'caller'
    &gt;&gt;&gt; def f():
    ...     return caller()
    &gt;&gt;&gt; f()
    'f'
    """
    </span><span style="color: blue; font-weight: bold">import </span>inspect
    <span style="color: blue; font-weight: bold">return </span>inspect<span style="font-weight: bold">.</span>getouterframes<span style="font-weight: bold">(</span>inspect<span style="font-weight: bold">.</span>currentframe<span style="font-weight: bold">())[</span>n<span style="font-weight: bold">][</span><span style="color: red">3</span><span style="font-weight: bold">]

</span><span style="color: blue; font-weight: bold">def </span>memoize<span style="font-weight: bold">(</span>fn<span style="font-weight: bold">, </span>slot<span style="font-weight: bold">=</span><span style="color: blue">None</span><span style="font-weight: bold">):
    </span><span style="color: darkred">"""Memoize fn: make it remember the computed value for any argument list.
    If slot is specified, store result in that slot of first argument.
    If slot is false, store results in a dictionary."""
    </span><span style="color: blue; font-weight: bold">if </span>slot<span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">def </span>memoized_fn<span style="font-weight: bold">(</span>obj<span style="font-weight: bold">, *</span>args<span style="font-weight: bold">):
            </span><span style="color: blue; font-weight: bold">if </span>hasattr<span style="font-weight: bold">(</span>obj<span style="font-weight: bold">, </span>slot<span style="font-weight: bold">):
                </span><span style="color: blue; font-weight: bold">return </span>getattr<span style="font-weight: bold">(</span>obj<span style="font-weight: bold">, </span>slot<span style="font-weight: bold">)
            </span><span style="color: blue; font-weight: bold">else</span><span style="font-weight: bold">:
                </span>val <span style="font-weight: bold">= </span>fn<span style="font-weight: bold">(</span>obj<span style="font-weight: bold">, *</span>args<span style="font-weight: bold">)
                </span>setattr<span style="font-weight: bold">(</span>obj<span style="font-weight: bold">, </span>slot<span style="font-weight: bold">, </span>val<span style="font-weight: bold">)
                </span><span style="color: blue; font-weight: bold">return </span>val
    <span style="color: blue; font-weight: bold">else</span><span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">def </span>memoized_fn<span style="font-weight: bold">(*</span>args<span style="font-weight: bold">):
            </span><span style="color: blue; font-weight: bold">if not </span>memoized_fn<span style="font-weight: bold">.</span>cache<span style="font-weight: bold">.</span>has_key<span style="font-weight: bold">(</span>args<span style="font-weight: bold">):
                </span>memoized_fn<span style="font-weight: bold">.</span>cache<span style="font-weight: bold">[</span>args<span style="font-weight: bold">] = </span>fn<span style="font-weight: bold">(*</span>args<span style="font-weight: bold">)
            </span><span style="color: blue; font-weight: bold">return </span>memoized_fn<span style="font-weight: bold">.</span>cache<span style="font-weight: bold">[</span>args<span style="font-weight: bold">]
        </span>memoized_fn<span style="font-weight: bold">.</span>cache <span style="font-weight: bold">= {}
    </span><span style="color: blue; font-weight: bold">return </span>memoized_fn

<span style="color: blue; font-weight: bold">def </span>if_<span style="font-weight: bold">(</span>test<span style="font-weight: bold">, </span>result<span style="font-weight: bold">, </span>alternative<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Like C++ and Java's (test ? result : alternative), except
    both result and alternative are always evaluated. However, if
    either evaluates to a function, it is applied to the empty arglist,
    so you can delay execution by putting it in a lambda.
    &gt;&gt;&gt; if_(2 + 2 == 4, 'ok', lambda: expensive_computation())
    'ok'
    """
    </span><span style="color: blue; font-weight: bold">if </span>test<span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">if </span>callable<span style="font-weight: bold">(</span>result<span style="font-weight: bold">): </span><span style="color: blue; font-weight: bold">return </span>result<span style="font-weight: bold">()
        </span><span style="color: blue; font-weight: bold">return </span>result
    <span style="color: blue; font-weight: bold">else</span><span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">if </span>callable<span style="font-weight: bold">(</span>alternative<span style="font-weight: bold">): </span><span style="color: blue; font-weight: bold">return </span>alternative<span style="font-weight: bold">()
        </span><span style="color: blue; font-weight: bold">return </span>alternative

<span style="color: blue; font-weight: bold">def </span>name<span style="font-weight: bold">(</span>object<span style="font-weight: bold">):
    </span><span style="color: red">"Try to find some reasonable name for the object."
    </span><span style="color: blue; font-weight: bold">return </span><span style="font-weight: bold">(</span>getattr<span style="font-weight: bold">(</span>object<span style="font-weight: bold">, </span><span style="color: red">'name'</span><span style="font-weight: bold">, </span><span style="color: red">0</span><span style="font-weight: bold">) </span><span style="color: blue; font-weight: bold">or </span>getattr<span style="font-weight: bold">(</span>object<span style="font-weight: bold">, </span><span style="color: red">'__name__'</span><span style="font-weight: bold">, </span><span style="color: red">0</span><span style="font-weight: bold">)
            </span><span style="color: blue; font-weight: bold">or </span>getattr<span style="font-weight: bold">(</span>getattr<span style="font-weight: bold">(</span>object<span style="font-weight: bold">, </span><span style="color: red">'__class__'</span><span style="font-weight: bold">, </span><span style="color: red">0</span><span style="font-weight: bold">), </span><span style="color: red">'__name__'</span><span style="font-weight: bold">, </span><span style="color: red">0</span><span style="font-weight: bold">)
            </span><span style="color: blue; font-weight: bold">or </span>str<span style="font-weight: bold">(</span>object<span style="font-weight: bold">))

</span><span style="color: blue; font-weight: bold">def </span>isnumber<span style="font-weight: bold">(</span>x<span style="font-weight: bold">):
    </span><span style="color: red">"Is x a number? We say it is if it has a __int__ method."
    </span><span style="color: blue; font-weight: bold">return </span>hasattr<span style="font-weight: bold">(</span>x<span style="font-weight: bold">, </span><span style="color: red">'__int__'</span><span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>issequence<span style="font-weight: bold">(</span>x<span style="font-weight: bold">):
    </span><span style="color: red">"Is x a sequence? We say it is if it has a __getitem__ method."
    </span><span style="color: blue; font-weight: bold">return </span>hasattr<span style="font-weight: bold">(</span>x<span style="font-weight: bold">, </span><span style="color: red">'__getitem__'</span><span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>print_table<span style="font-weight: bold">(</span>table<span style="font-weight: bold">, </span>header<span style="font-weight: bold">=</span><span style="color: blue">None</span><span style="font-weight: bold">, </span>sep<span style="font-weight: bold">=</span><span style="color: red">'   '</span><span style="font-weight: bold">, </span>numfmt<span style="font-weight: bold">=</span><span style="color: red">'%g'</span><span style="font-weight: bold">):
    </span><span style="color: darkred">"""Print a list of lists as a table, so that columns line up nicely.
    header, if specified, will be printed as the first row.
    numfmt is the format for all numbers; you might want e.g. '%6.2f'.
    (If you want different formats in different columns, don't use print_table.)
    sep is the separator between columns."""
    </span>justs <span style="font-weight: bold">= [</span>if_<span style="font-weight: bold">(</span>isnumber<span style="font-weight: bold">(</span>x<span style="font-weight: bold">), </span><span style="color: red">'rjust'</span><span style="font-weight: bold">, </span><span style="color: red">'ljust'</span><span style="font-weight: bold">) </span><span style="color: blue; font-weight: bold">for </span>x <span style="color: blue; font-weight: bold">in </span>table<span style="font-weight: bold">[</span><span style="color: red">0</span><span style="font-weight: bold">]]
    </span><span style="color: blue; font-weight: bold">if </span>header<span style="font-weight: bold">:
        </span>table <span style="font-weight: bold">= [</span>header<span style="font-weight: bold">] + </span>table
    table <span style="font-weight: bold">= [[</span>if_<span style="font-weight: bold">(</span>isnumber<span style="font-weight: bold">(</span>x<span style="font-weight: bold">), </span><span style="color: blue; font-weight: bold">lambda</span><span style="font-weight: bold">: </span>numfmt <span style="font-weight: bold">% </span>x<span style="font-weight: bold">, </span><span style="color: blue; font-weight: bold">lambda</span><span style="font-weight: bold">: </span>x<span style="font-weight: bold">) </span><span style="color: blue; font-weight: bold">for </span>x <span style="color: blue; font-weight: bold">in </span>row<span style="font-weight: bold">]
             </span><span style="color: blue; font-weight: bold">for </span>row <span style="color: blue; font-weight: bold">in </span>table<span style="font-weight: bold">]
    </span>maxlen <span style="font-weight: bold">= </span><span style="color: blue; font-weight: bold">lambda </span>seq<span style="font-weight: bold">: </span>max<span style="font-weight: bold">(</span>map<span style="font-weight: bold">(</span>len<span style="font-weight: bold">, </span>seq<span style="font-weight: bold">))
    </span>sizes <span style="font-weight: bold">= </span>map<span style="font-weight: bold">(</span>maxlen<span style="font-weight: bold">, </span>zip<span style="font-weight: bold">(*[</span>map<span style="font-weight: bold">(</span>str<span style="font-weight: bold">, </span>row<span style="font-weight: bold">) </span><span style="color: blue; font-weight: bold">for </span>row <span style="color: blue; font-weight: bold">in </span>table<span style="font-weight: bold">]))
    </span><span style="color: blue; font-weight: bold">for </span>row <span style="color: blue; font-weight: bold">in </span>table<span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">print </span>sep<span style="font-weight: bold">.</span>join<span style="font-weight: bold">(</span>getattr<span style="font-weight: bold">(</span>str<span style="font-weight: bold">(</span>x<span style="font-weight: bold">), </span>j<span style="font-weight: bold">)(</span>size<span style="font-weight: bold">)
                       </span><span style="color: blue; font-weight: bold">for </span><span style="font-weight: bold">(</span>j<span style="font-weight: bold">, </span>size<span style="font-weight: bold">, </span>x<span style="font-weight: bold">) </span><span style="color: blue; font-weight: bold">in </span>zip<span style="font-weight: bold">(</span>justs<span style="font-weight: bold">, </span>sizes<span style="font-weight: bold">, </span>row<span style="font-weight: bold">))

</span><span style="color: blue; font-weight: bold">def </span>AIMAFile<span style="font-weight: bold">(</span>components<span style="font-weight: bold">, </span>mode<span style="font-weight: bold">=</span><span style="color: red">'r'</span><span style="font-weight: bold">):
    </span><span style="color: red">"Open a file based at the AIMA root directory."
    </span><span style="color: blue; font-weight: bold">import </span>utils
    dir <span style="font-weight: bold">= </span>os<span style="font-weight: bold">.</span>path<span style="font-weight: bold">.</span>dirname<span style="font-weight: bold">(</span>utils<span style="font-weight: bold">.</span>__file__<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">return </span>open<span style="font-weight: bold">(</span>apply<span style="font-weight: bold">(</span>os<span style="font-weight: bold">.</span>path<span style="font-weight: bold">.</span>join<span style="font-weight: bold">, [</span>dir<span style="font-weight: bold">] + </span>components<span style="font-weight: bold">), </span>mode<span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>DataFile<span style="font-weight: bold">(</span>name<span style="font-weight: bold">, </span>mode<span style="font-weight: bold">=</span><span style="color: red">'r'</span><span style="font-weight: bold">):
    </span><span style="color: red">"Return a file in the AIMA /data directory."
    </span><span style="color: blue; font-weight: bold">return </span>AIMAFile<span style="font-weight: bold">([</span><span style="color: red">'..'</span><span style="font-weight: bold">, </span><span style="color: red">'data'</span><span style="font-weight: bold">, </span>name<span style="font-weight: bold">], </span>mode<span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>unimplemented<span style="font-weight: bold">():
    </span><span style="color: red">"Use this as a stub for not-yet-implemented functions."
    </span><span style="color: blue; font-weight: bold">raise </span>NotImplementedError

<span style="color: green; font-style: italic">#______________________________________________________________________________
# CTM: misc Wumpus utils

</span><span style="color: blue; font-weight: bold">def </span>all_empty_strings<span style="font-weight: bold">(</span>list<span style="font-weight: bold">):
    </span><span style="color: darkred">"""
    Returns true if all strings in list are empty strings, e.g.: ['','','']
    Used to test whether an axiom_generator has been implemented.
    """
    </span><span style="color: blue; font-weight: bold">for </span>s <span style="color: blue; font-weight: bold">in </span>list<span style="font-weight: bold">:
        </span><span style="color: blue; font-weight: bold">if </span>s<span style="font-weight: bold">: </span><span style="color: blue; font-weight: bold">return False
    return True

def </span>print_not_implemented<span style="font-weight: bold">(</span>name<span style="font-weight: bold">=</span><span style="color: blue">None</span><span style="font-weight: bold">):
    </span><span style="color: darkred">"""
    Used to express during runtime whether function has been implemented.
    Instances of these functions occuring directly after instances of
    "*** YOUR CODE HERE ***" may be commented-out or deleted once the
    function has been implemented.
    (It is not recommended to remove instances of these fns
    elsewhere: instead, a test will determine whether the fn has been
    implemented and print_not_implemented gets called.)
    """
    </span><span style="color: blue; font-weight: bold">print </span><span style="color: red">"--&gt; {0}() is not implemented."</span><span style="font-weight: bold">.</span>format<span style="font-weight: bold">(</span>name <span style="color: blue; font-weight: bold">if </span>name <span style="font-weight: bold">!= </span><span style="color: blue">None </span><span style="color: blue; font-weight: bold">else </span>caller<span style="font-weight: bold">(</span><span style="color: red">2</span><span style="font-weight: bold">))

</span><span style="color: green; font-style: italic">#______________________________________________________________________________
# Queues: Stack, FIFOQueue, PriorityQueue

</span><span style="color: blue; font-weight: bold">class </span>Queue<span style="font-weight: bold">:
    </span><span style="color: darkred">"""Queue is an abstract class/interface. There are three types:
        Stack(): A Last In First Out Queue.
        FIFOQueue(): A First In First Out Queue.
        PriorityQueue(order, f): Queue in sorted order (default min-first).
    Each type supports the following methods and functions:
        q.append(item)  -- add an item to the queue
        q.extend(items) -- equivalent to: for item in items: q.append(item)
        q.pop()         -- return the top item from the queue
        len(q)          -- number of items in q (also q.__len())
        item in q       -- does q contain item?
    Note that isinstance(Stack(), Queue) is false, because we implement stacks
    as lists.  If Python ever gets interfaces, Queue will be an interface."""

    </span><span style="color: blue; font-weight: bold">def </span>__init__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
        </span>abstract

    <span style="color: blue; font-weight: bold">def </span>extend<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>items<span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">for </span>item <span style="color: blue; font-weight: bold">in </span>items<span style="font-weight: bold">: </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>append<span style="font-weight: bold">(</span>item<span style="font-weight: bold">)

</span><span style="color: blue; font-weight: bold">def </span>Stack<span style="font-weight: bold">():
    </span><span style="color: darkred">"""Return an empty list, suitable as a Last-In-First-Out Queue."""
    </span><span style="color: blue; font-weight: bold">return </span><span style="font-weight: bold">[]

</span><span style="color: blue; font-weight: bold">class </span>FIFOQueue<span style="font-weight: bold">(</span>Queue<span style="font-weight: bold">):
    </span><span style="color: darkred">"""A First-In-First-Out Queue."""
    </span><span style="color: blue; font-weight: bold">def </span>__init__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
        </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A <span style="font-weight: bold">= []</span>; <span style="color: blue">self</span><span style="font-weight: bold">.</span>start <span style="font-weight: bold">= </span><span style="color: red">0
    </span><span style="color: blue; font-weight: bold">def </span>append<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>item<span style="font-weight: bold">):
        </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">.</span>append<span style="font-weight: bold">(</span>item<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">def </span>__len__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">return </span>len<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">) - </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>start
    <span style="color: blue; font-weight: bold">def </span>extend<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>items<span style="font-weight: bold">):
        </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">.</span>extend<span style="font-weight: bold">(</span>items<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">def </span>pop<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
        </span>e <span style="font-weight: bold">= </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">[</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>start<span style="font-weight: bold">]
        </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>start <span style="font-weight: bold">+= </span><span style="color: red">1
        </span><span style="color: blue; font-weight: bold">if </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>start <span style="font-weight: bold">&gt; </span><span style="color: red">5 </span><span style="color: blue; font-weight: bold">and </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>start <span style="font-weight: bold">&gt; </span>len<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">)/</span><span style="color: red">2</span><span style="font-weight: bold">:
            </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A <span style="font-weight: bold">= </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">[</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>start<span style="font-weight: bold">:]
            </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>start <span style="font-weight: bold">= </span><span style="color: red">0
        </span><span style="color: blue; font-weight: bold">return </span>e
    <span style="color: blue; font-weight: bold">def </span>__contains__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>item<span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">return </span>item <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">[</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>start<span style="font-weight: bold">:]

</span><span style="color: blue; font-weight: bold">class </span>PriorityQueue<span style="font-weight: bold">(</span>Queue<span style="font-weight: bold">):
    </span><span style="color: darkred">"""A queue in which the minimum (or maximum) element (as determined by f and
    order) is returned first. If order is min, the item with minimum f(x) is
    returned first; if order is max, then it is the item with maximum f(x).
    Also supports dict-like lookup."""
    </span><span style="color: blue; font-weight: bold">def </span>__init__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>order<span style="font-weight: bold">=</span>min<span style="font-weight: bold">, </span>f<span style="font-weight: bold">=</span><span style="color: blue; font-weight: bold">lambda </span>x<span style="font-weight: bold">: </span>x<span style="font-weight: bold">):
        </span>update<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>A<span style="font-weight: bold">=[], </span>order<span style="font-weight: bold">=</span>order<span style="font-weight: bold">, </span>f<span style="font-weight: bold">=</span>f<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">def </span>append<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>item<span style="font-weight: bold">):
        </span>bisect<span style="font-weight: bold">.</span>insort<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">, (</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>f<span style="font-weight: bold">(</span>item<span style="font-weight: bold">), </span>item<span style="font-weight: bold">))
    </span><span style="color: blue; font-weight: bold">def </span>__len__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">return </span>len<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">def </span>pop<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">if </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>order <span style="font-weight: bold">== </span>min<span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">return </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">.</span>pop<span style="font-weight: bold">(</span><span style="color: red">0</span><span style="font-weight: bold">)[</span><span style="color: red">1</span><span style="font-weight: bold">]
        </span><span style="color: blue; font-weight: bold">else</span><span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">return </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">.</span>pop<span style="font-weight: bold">()[</span><span style="color: red">1</span><span style="font-weight: bold">]
    </span><span style="color: blue; font-weight: bold">def </span>__contains__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>item<span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">return </span>some<span style="font-weight: bold">(</span><span style="color: blue; font-weight: bold">lambda </span><span style="font-weight: bold">(</span>_<span style="font-weight: bold">, </span>x<span style="font-weight: bold">): </span>x <span style="font-weight: bold">== </span>item<span style="font-weight: bold">, </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">def </span>__getitem__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>key<span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">for </span>_<span style="font-weight: bold">, </span>item <span style="color: blue; font-weight: bold">in </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">if </span>item <span style="font-weight: bold">== </span>key<span style="font-weight: bold">:
                </span><span style="color: blue; font-weight: bold">return </span>item
    <span style="color: blue; font-weight: bold">def </span>__delitem__<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">, </span>key<span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">for </span>i<span style="font-weight: bold">, (</span>value<span style="font-weight: bold">, </span>item<span style="font-weight: bold">) </span><span style="color: blue; font-weight: bold">in </span>enumerate<span style="font-weight: bold">(</span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">):
            </span><span style="color: blue; font-weight: bold">if </span>item <span style="font-weight: bold">== </span>key<span style="font-weight: bold">:
                </span><span style="color: blue">self</span><span style="font-weight: bold">.</span>A<span style="font-weight: bold">.</span>pop<span style="font-weight: bold">(</span>i<span style="font-weight: bold">)
                </span><span style="color: blue; font-weight: bold">return

</span><span style="color: green; font-style: italic">## Fig: The idea is we can define things like Fig[3,10] later.
## Alas, it is Fig[3,10] not Fig[3.10], because that would be the same
## as Fig[3.1]
</span>Fig <span style="font-weight: bold">= {}

</span><span style="color: green; font-style: italic">#______________________________________________________________________________
# Support for doctest

</span><span style="color: blue; font-weight: bold">def </span>ignore<span style="font-weight: bold">(</span>x<span style="font-weight: bold">): </span><span style="color: blue">None

</span><span style="color: blue; font-weight: bold">def </span>random_tests<span style="font-weight: bold">(</span>text<span style="font-weight: bold">):
    </span><span style="color: darkred">"""Some functions are stochastic. We want to be able to write a test
    with random output.  We do that by ignoring the output."""
    </span><span style="color: blue; font-weight: bold">def </span>fixup<span style="font-weight: bold">(</span>test<span style="font-weight: bold">):
        </span><span style="color: blue; font-weight: bold">if </span><span style="color: red">" = " </span><span style="color: blue; font-weight: bold">in </span>test<span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">return </span><span style="color: red">"&gt;&gt;&gt; " </span><span style="font-weight: bold">+ </span>test
        <span style="color: blue; font-weight: bold">else</span><span style="font-weight: bold">:
            </span><span style="color: blue; font-weight: bold">return </span><span style="color: red">"&gt;&gt;&gt; ignore(" </span><span style="font-weight: bold">+ </span>test <span style="font-weight: bold">+ </span><span style="color: red">")"
    </span>tests <span style="font-weight: bold">=  </span>re<span style="font-weight: bold">.</span>findall<span style="font-weight: bold">(</span><span style="color: red">"&gt;&gt;&gt; (.*)"</span><span style="font-weight: bold">, </span>text<span style="font-weight: bold">)
    </span><span style="color: blue; font-weight: bold">return </span><span style="color: red">'\n'</span><span style="font-weight: bold">.</span>join<span style="font-weight: bold">(</span>map<span style="font-weight: bold">(</span>fixup<span style="font-weight: bold">, </span>tests<span style="font-weight: bold">))

</span><span style="color: green; font-style: italic">#______________________________________________________________________________

</span>__doc__ <span style="font-weight: bold">+= </span><span style="color: darkred">"""
&gt;&gt;&gt; d = DefaultDict(0)
&gt;&gt;&gt; d['x'] += 1
&gt;&gt;&gt; d['x']
1

&gt;&gt;&gt; d = DefaultDict([])
&gt;&gt;&gt; d['x'] += [1]
&gt;&gt;&gt; d['y'] += [2]
&gt;&gt;&gt; d['x']
[1]

&gt;&gt;&gt; s = Struct(a=1, b=2)
&gt;&gt;&gt; s.a
1
&gt;&gt;&gt; s.a = 3
&gt;&gt;&gt; s
Struct(a=3, b=2)

&gt;&gt;&gt; def is_even(x):
...     return x % 2 == 0
&gt;&gt;&gt; sorted([1, 2, -3])
[-3, 1, 2]
&gt;&gt;&gt; sorted(range(10), key=is_even)
[1, 3, 5, 7, 9, 0, 2, 4, 6, 8]
&gt;&gt;&gt; sorted(range(10), lambda x,y: y-x)
[9, 8, 7, 6, 5, 4, 3, 2, 1, 0]

&gt;&gt;&gt; removeall(4, [])
[]
&gt;&gt;&gt; removeall('s', 'This is a test. Was a test.')
'Thi i a tet. Wa a tet.'
&gt;&gt;&gt; removeall('s', 'Something')
'Something'
&gt;&gt;&gt; removeall('s', '')
''

&gt;&gt;&gt; list(reversed([]))
[]

&gt;&gt;&gt; count_if(is_even, [1, 2, 3, 4])
2
&gt;&gt;&gt; count_if(is_even, [])
0

&gt;&gt;&gt; argmax([1], lambda x: x*x)
1
&gt;&gt;&gt; argmin([1], lambda x: x*x)
1


# Test of memoize with slots in structures
&gt;&gt;&gt; countries = [Struct(name='united states'), Struct(name='canada')]

# Pretend that 'gnp' was some big hairy operation:
&gt;&gt;&gt; def gnp(country):
...     print 'calculating gnp ...'
...     return len(country.name) * 1e10

&gt;&gt;&gt; gnp = memoize(gnp, '_gnp')
&gt;&gt;&gt; map(gnp, countries)
calculating gnp ...
calculating gnp ...
[130000000000.0, 60000000000.0]
&gt;&gt;&gt; countries
[Struct(_gnp=130000000000.0, name='united states'), Struct(_gnp=60000000000.0, name='canada')]

# This time we avoid re-doing the calculation
&gt;&gt;&gt; map(gnp, countries)
[130000000000.0, 60000000000.0]

# Test Queues:
&gt;&gt;&gt; nums = [1, 8, 2, 7, 5, 6, -99, 99, 4, 3, 0]
&gt;&gt;&gt; def qtest(q):
...     q.extend(nums)
...     for num in nums: assert num in q
...     assert 42 not in q
...     return [q.pop() for i in range(len(q))]
&gt;&gt;&gt; qtest(Stack())
[0, 3, 4, 99, -99, 6, 5, 7, 2, 8, 1]

&gt;&gt;&gt; qtest(FIFOQueue())
[1, 8, 2, 7, 5, 6, -99, 99, 4, 3, 0]

&gt;&gt;&gt; qtest(PriorityQueue(min))
[-99, 0, 1, 2, 3, 4, 5, 6, 7, 8, 99]

&gt;&gt;&gt; qtest(PriorityQueue(max))
[99, 8, 7, 6, 5, 4, 3, 2, 1, 0, -99]

&gt;&gt;&gt; qtest(PriorityQueue(min, abs))
[0, 1, 2, 3, 4, 5, 6, 7, 8, -99, 99]

&gt;&gt;&gt; qtest(PriorityQueue(max, abs))
[99, -99, 8, 7, 6, 5, 4, 3, 2, 1, 0]

&gt;&gt;&gt; vals = [100, 110, 160, 200, 160, 110, 200, 200, 220]
&gt;&gt;&gt; histogram(vals)
[(100, 1), (110, 2), (160, 2), (200, 3), (220, 1)]
&gt;&gt;&gt; histogram(vals, 1)
[(200, 3), (160, 2), (110, 2), (220, 1), (100, 1)]
&gt;&gt;&gt; histogram(vals, 1, lambda v: round(v, -2))
[(200.0, 6), (100.0, 3)]

&gt;&gt;&gt; log2(1.0)
0.0

&gt;&gt;&gt; def fib(n):
...     return (n&lt;=1 and 1) or (fib(n-1) + fib(n-2))

&gt;&gt;&gt; fib(9)
55

# Now we make it faster:
&gt;&gt;&gt; fib = memoize(fib)
&gt;&gt;&gt; fib(9)
55

&gt;&gt;&gt; q = Stack()
&gt;&gt;&gt; q.append(1)
&gt;&gt;&gt; q.append(2)
&gt;&gt;&gt; q.pop(), q.pop()
(2, 1)

&gt;&gt;&gt; q = FIFOQueue()
&gt;&gt;&gt; q.append(1)
&gt;&gt;&gt; q.append(2)
&gt;&gt;&gt; q.pop(), q.pop()
(1, 2)


&gt;&gt;&gt; abc = set('abc')
&gt;&gt;&gt; bcd = set('bcd')
&gt;&gt;&gt; 'a' in abc
True
&gt;&gt;&gt; 'a' in bcd
False
&gt;&gt;&gt; list(abc.intersection(bcd))
['c', 'b']
&gt;&gt;&gt; list(abc.union(bcd))
['a', 'c', 'b', 'd']

## From "What's new in Python 2.4", but I added calls to sl

&gt;&gt;&gt; def sl(x):
...     return sorted(list(x))


&gt;&gt;&gt; a = set('abracadabra')                  # form a set from a string
&gt;&gt;&gt; 'z' in a                                # fast membership testing
False
&gt;&gt;&gt; sl(a)                                   # unique letters in a
['a', 'b', 'c', 'd', 'r']

&gt;&gt;&gt; b = set('alacazam')                     # form a second set
&gt;&gt;&gt; sl(a - b)                               # letters in a but not in b
['b', 'd', 'r']
&gt;&gt;&gt; sl(a | b)                               # letters in either a or b
['a', 'b', 'c', 'd', 'l', 'm', 'r', 'z']
&gt;&gt;&gt; sl(a &amp; b)                               # letters in both a and b
['a', 'c']
&gt;&gt;&gt; sl(a ^ b)                               # letters in a or b but not both
['b', 'd', 'l', 'm', 'r', 'z']


&gt;&gt;&gt; a.add('z')                              # add a new element
&gt;&gt;&gt; a.update('wxy')                         # add multiple new elements
&gt;&gt;&gt; sl(a)
['a', 'b', 'c', 'd', 'r', 'w', 'x', 'y', 'z']
&gt;&gt;&gt; a.remove('x')                           # take one element out
&gt;&gt;&gt; sl(a)
['a', 'b', 'c', 'd', 'r', 'w', 'y', 'z']

&gt;&gt;&gt; weighted_sample_with_replacement([], [], 0)
[]
&gt;&gt;&gt; weighted_sample_with_replacement('a', [3], 2)
['a', 'a']
&gt;&gt;&gt; weighted_sample_with_replacement('ab', [0, 3], 3)
['b', 'b', 'b']
"""

</span>__doc__ <span style="font-weight: bold">+= </span>random_tests<span style="font-weight: bold">(</span><span style="color: darkred">"""
&gt;&gt;&gt; weighted_sample_with_replacement(range(10), [x*x for x in range(10)], 3)
[8, 9, 6]
"""</span><span style="font-weight: bold">)
</span>
    </pre>
    </body>
    </html>
    